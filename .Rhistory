# this calcultes the herd size at the end of breeding period
BL <- NULL # bulls
MC <- NULL # Mature cow
WH <- NULL # Weaning heifers
FC <- NULL # First calving cow
CM <- NULL # Male calf
CF <- NULL # Female calf
P <- NULL  # pregnant
E <- NULL  # empty
# if (BLL) id <- (010001:019999)
# if (MC || FC) id <- (020001:029999)
# if (WH) id <- (030001:039999)
# if (CM || CF) id <- (040001:049999)
########### Year1: Bulls in/out, conception, pregnancy, and calving events #############
########################################################################################
# Initial herd composition
# At the start of breeding period with the addition of bulls, bulls not counted in herd population
MC <- 50
WH <- 50
herd <- c(MC, WH)
herdSize <- sum(MC, WH)
# After pregnency test (assuming 90% fertility)
MC_pregnent <- 0.9 * MC
WH_pregnent <- 0.9 * WH
# all empty cows culled out
MC_empty <- (MC - MC_pregnent)
WH_empty <- (WH - WH_pregnent)
# After calving, male calfs and female calfs
CM <- sum(MC_pregnent, WH_pregnent)/2
CF <- sum(MC_pregnent, WH_pregnent)/2
MC <- MC_pregnent
FC <- WH_pregnent
herdSize <- MC + FC + CM + CF
# herd composition at the end of year 1
herd_yr1 <- c(MC, FC, CM, CF)
############# Year2: No change in herd during the year, calves at foot #################
########################################################################################
# change in herd at the end of year 2
MC_removed <- 0.2 * MC  #  20% mature cows removed
FC_removed <- 0.2 * FC  # 20% first calving cows removed
cM_removed <- CM        # all male calves removed
CF_removed <- 0.8 * CF  # 80% female calves removed
# herd composition at the end of year 2
MC <- MC - MC_removed
FC <- FC - FC_removed
WH <- CF - CF_removed   # female calves now became weaning heifer
herd_yr2 <- c(MC, FC, WH)
########################## Year 3: repeats year 1 steps   ##############################
########################################################################################
#initial herd compostion; bulls added to the herd but not counted in herd size
herd_yr2
herdSize <- sum(herd_yr2)
# repeats year 1 stages
# After pregnency test (assuming 90% fertility)
MC_pregnent <- 0.9 * MC
FC_pregnent <- 0.9 * FC
WH_pregnent <- 0.9 * WH
# all empty cows culled out
MC_empty <- (MC - MC_pregnent)
FC_empty <- (FC - FC_pregnent)
WH_empty <- (WH - WH_pregnent)
# After calving, male calfs and female calfs
CM <- sum(MC_pregnent, FC_pregnent, WH_pregnent)/2
CF <- sum(MC_pregnent, FC_pregnent, WH_pregnent)/2
MC <- sum(MC_pregnent, FC_pregnent)
FC <- WH_pregnent
herdSize <- MC + FC + CM + CF
# herd composition at the end of year 3
herd_yr3 <- c(MC, FC, CM, CF)
########################## Year 4: repeats year 2 steps   ##############################
########################################################################################
# change in herd at the end of year 4
MC_removed <- 0.2 * MC  #  20% mature cows removed
FC_removed <- 0.2 * FC  # 20% first calving cows removed
cM_removed <- CM        # all male calves removed
CF_removed <- 0.8 * CF  # 80% female calves removed, 20% stay in the herd
# herd composition at the end of year 2
MC <- MC - MC_removed
FC <- FC - FC_removed
WH <- CF - CF_removed   # female calves now became weaning heifer
herd_yr4 <- c(MC, FC, WH)
herd_yr4
# this simulates the genetic merit of individual animal
set.seed(1)
n <- 100 # initial herd size
id <- c(01001:01100)
age <- runif(n, min = 12, max = 120) # in months
daily_wt <- rnorm(n, 0.8, 0.4) # in kgs
fertility <- rnorm(n, 0.9, 0.2)
cow_attributes <- cbind(id, age, daily_wt, fertility)
# linear model to calculate genetic merit
genetic_merit <- age * 0.08 + daily_wt + fertility
data_table <- cbind(cow_attributes, genetic_merit)
# simulation runs
reps <- 1000
sim_result <- rep(NA, reps)
for(i in 1:reps){
sample <- rnorm(n, mean = mean(genetic_merit), sd = sd(genetic_merit))
sim_result[i] <- mean(sample)
}
sim_result
n = 100
# define function
final_wt <- function(n, mean, sd){
birth_wt <- rnorm (n, 40, 7.5)
daily_wt <- rnorm(n, 0.8, 0.4)
final_wt <- mean(birth_wt) + mean(daily_wt)*365
return(list("final_wt" = final_wt))
}
n_grid <- 100
mean_grid <- 40
sd_grid <- 7.5
param_list = list("n"=n_grid, "mean"=mean_grid, "sd"= sd_grid)
result <- MonteCarlo(func = final_wt, nrep = 1000, param_list = param_list)
result
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(d){
LWT <- BW + WG * d
}
WT(10)
WT(10)
WT(10)
WT
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(d){
LWT <- BW + WG * d
return(LWT)
}
WT(10)
WT(100)
for (i in 1:3650){
print(i)
}
for (i in 1:3650){
print(WT)
}
for (i in 1:3650){
print(WT(d))
}
for (i in 1:3650){
print(WT(10))
}
for (i in 1:3650){
print(WT)
}
for (i in d){
print(WT)
}
#calculatio of liveweight from birth (day 0) to death (day 3650)
d <- 1:3650
for (i in d){
print(WT)
}
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(){
LWT <- BW + WG * d
return(LWT)
}
#calculatio of liveweight from birth (day 0) to death (day 3650)
d <- 1:3650
for (i in d){
print(WT)
}
wt
WT
WT(10)
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(d){
LWT <- BW + WG * d
print (LWT)
}
#calculatio of liveweight from birth (day 0) to death (day 3650)
d <- 1:3650
for (i in d){
print(WT)
}
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(d){
LWT <- BW + WG * d
return(LWT)
}
#calculatio of liveweight from birth (day 0) to death (day 3650)
d <- 1:3650
for (i in d){
print(WT)
}
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(d){
LWT <- BW + WG * d
return(LWT)
}
#calculatio of liveweight from birth (day 0) to death (day 3650)
d <- 1:3650
for (i in d){
return (WT)
}
WT
WT(1)
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(d){
LWT <- BW + WG * d
return(LWT)
}
#calculatio of liveweight from birth (day 0) to death (day 3650)
d <- 1:3650
for (i in WT(d)){
return (WT)
}
WT
# Birth weigth in Kg
BW <- 40
# daily weight gain in kg
WG <- 0.8
#weight of an animal on day d
WT <- function(d){
LWT <- BW + WG * d
return(LWT)
}
#calculatio of liveweight from birth (day 0) to death (day 3650)
d <- 1:3650
WT1 <- for (i in WT(d)){
return (WT)
}
WT1
